# Malware-Analysis

using Drebin dataset to distinguish between malwares and not malwares

## Libraries

- python 3.7.1 (x64)
- pip 18.1
- python3 -m pip install -r requirements.txt

## How it works

![Check docs/how_it_works.md](https://github.com/elsheikh21/malware-analysis/blob/master/docs/how_it_works.md)

---

## **Output:**

### Features Selection using **unbalanced data**

![K BEST classifier features importance output unbalanced dataset](https://github.com/elsheikh21/malware-analysis/blob/master/Extras/K%20BEST%20classifier%20features%20importance%20output.bmp)

![RFE classifier features importance output unbalanced dataset](https://github.com/elsheikh21/malware-analysis/blob/master/Extras/RFE%20classifier%20features%20importance%20output.bmp)

![extra trees classifier classifier features importance graph unbalanced dataset](https://github.com/elsheikh21/malware-analysis/blob/master/Extras/extra%20trees%20classifier%20features%20importance%20graph%201.bmp)

![random forest classifier features importance graph unbalanced dataset](https://github.com/elsheikh21/malware-analysis/blob/master/Extras/random%20forrest%20classifier%20features%20importance%20graph%201.bmp)

### Features Selection using **balanced data**

![K BEST classifier features importance output balanced dataset](https://github.com/elsheikh21/malware-analysis/blob/master/Extras/K%20BEST%20classifier%20features%20importance%20output%20balanced%20dataset.png)

![RFE classifier features importance output balanced dataset](https://github.com/elsheikh21/malware-analysis/blob/master/Extras/RFE%20classifier%20features%20importance%20output%20balanced%20dataset.png)

![extra trees classifier classifier features importance graph balanced dataset](https://github.com/elsheikh21/malware-analysis/blob/master/Extras/Figure_1%20balanced%20dataset.png)

![random forest classifier features importance graph balanced dataset](https://github.com/elsheikh21/malware-analysis/blob/master/Extras/Figure_2%20balanced%20dataset.png)

---

3.  Using `train_test_split()` function from `sklearn.model_selection` to split our data into 2 categories testing (20%) and training data (80%), and print out their shapes for representation purposes
4.  Use `train.py` which includes all the training models, as well as their performance metrices
    1. fit the model using the training data
       - SVM
       - Extra Trees
       - Random forest
       - Recursive features elimination
       - Naive Bayes
    2. Predict the x_test
    3. Build confusion matrix, and use the evaluation metrices
       - Accuracy
       - Precision
       - Recall
       - F1 score

---

- But why we do features selection?

  - Three benefits of performing feature selection before modeling your data are:

  1. Reduces Overfitting: Less redundant data means less opportunity to make decisions based on noise.
  2. Improves Accuracy: Less misleading data means modeling accuracy improves.
  3. Reduces Training Time: Less data means that algorithms train faster.

---

- Difference between Extra trees classifier and Random forest classifier?
  - First thing first, extra trees is named Extremely Randomized Tress
  - Secondly, Random Forest and Extremely Randomized Trees differ in the sense that the splits of the trees in the Random Forest are deterministic whereas they are random in the case of an Extremely Randomized Trees (to be more accurate, the next split is the best split among random uniform splits in the selected variables for the current tree).
  - Extra trees seem to keep a higher performance in presence of noisy features.
  - When all the variables are relevant, both methods seem to achieve the same performance, Extra trees seem three times faster than the random forest (at least, in scikit learn implementation)

---

## **Performance metrices**

### Performance metrices of algorithms used to train model using **UNBALANCED dataset**

![Performance metrices of algorithms used to train model](https://github.com/elsheikh21/malware-analysis/blob/master/Extras/Performance%20metrices%20of%20algorithms%20used%20to%20train%20model.png)

### Performance metrices of algorithms used to train model using **BALANCED dataset**

![Performance metrices of algorithms used to train model balanced data](https://github.com/elsheikh21/malware-analysis/blob/master/Extras/Performance%20metrices%20of%20algorithms%20used%20to%20train%20model%20balanced%20data.png)

---
